#!/usr/bin/env python3

"""Wrapper script for running the Pitivi integration tests."""

import os
import subprocess
import sys

GST_VALIDATE_LAUNCHER_COMMAND = "gst-validate-launcher"

if (os.system(GST_VALIDATE_LAUNCHER_COMMAND + " -h > %s 2>&1" % os.devnull) != 0):
    print("Make sure to install gst-validate: http://cgit.freedesktop.org/gstreamer/gst-devtools/tree/validate/"
          " before running the testsuite")
    sys.exit(127)

path = os.path.abspath(os.path.join(os.path.dirname(__file__)))  # pylint: disable=invalid-name
# Path to scan for GstValidate TestsManager subclasses.
os.environ["GST_VALIDATE_APPS_DIR"] = path
testsuite = os.path.join(path, "pitivi.py")  # pylint: disable=invalid-name
command = [GST_VALIDATE_LAUNCHER_COMMAND, testsuite]  # pylint: disable=invalid-name
command.extend(sys.argv[1:])
sys.exit(subprocess.call(command))
